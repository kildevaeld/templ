!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.templ=e():t.templ=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t,e){"function"!=typeof e&&(e=h.extendClass(f.BaseAttribute,e)),f[t]=e}function i(t,e){"function"!=typeof e&&(e=h.extendClass(l.BaseComponent,e)),l[t]=e}function o(t,e){p[t]=e}function s(t){h.Debug.enable(t)}function u(t,e){var n=c,r=v.compile(t),i=r(n.fragment,n.element,n.text,n.comment,n.dynamic,y.binding);return n.template(i,h.extend({document:document,viewClass:d.View,attributes:new a.Repository(f),components:new a.Repository(l),modifiers:p,runloop:new b.RunLoop},e||{}))}var a=n(1),c=n(2),l=n(16),f=n(20),p=n(26),h=n(7),d=n(19),v=n(27),y=n(29),b=n(30);e.version="$$version$$",e.attribute=r,e.component=i,e.modifier=o,e.debugging=s,e.compile=u},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){n(this,t),this.values=e||{}}return t.prototype.set=function(t,e){this.values[t]=e},t.prototype.get=function(t){return this.values[t]},t.prototype.has=function(t){return!!this.get(t)},t.prototype["delete"]=function(t){delete this.values[t]},t}();e.Repository=r},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}r(n(3)),r(n(4)),r(n(6)),r(n(10)),r(n(11)),r(n(12)),r(n(15)),r(n(13)),r(n(5))},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){n(this,t),this.nodeType=8,this.nodeValue=e}return t.prototype.render=function(t){return Promise.resolve(t.document.createComment(this.nodeValue))},t}();e.Comment=r,e.comment=function(t){return new r(t)}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(5),o=function(){function t(e,n){r(this,t),this.nodeType=-200,this.vnode=e,this.bindingClass=n,this.vnode.parentNode=this}return t.prototype.render=function(t,e){return t.components.has(this.vnode.tagName)?this._renderComponent(t,e):this._renderElement(t,e)},t.prototype._renderElement=function(t,e){var n=this;return this.vnode.render(t,e).then(function(r){return e.push(new u(r,n.bindingClass,t)),r})},t.prototype._renderComponent=function(t,e){var n=this,r=[];return this.vnode.render(t,r).then(function(i){return e.push(new s(r[0],n.bindingClass,t)),i})},t}();e.Dynamic=o,e.dynamic=function(t,e){return new o(t,e)};var s=function(){function t(e,n,i){r(this,t),this.renderer=e,this.bindingClass=n,this.options=i}return t.prototype.generate=function(t,e){var n=this;return this.renderer.generate(t,e).then(function(){var t=e.bindings[e.bindings.length-1];e.bindings.splice(e.bindings.indexOf(t),0,new n.bindingClass(t,e))})},t}(),u=function(){function t(e,n,i){r(this,t),this.ref=e,this.bindingClass=n,this.options=i}return t.prototype.generate=function(t,e){return this._refPath||(this._refPath=i.getNodePath(this.ref)),e.bindings.push(new this.bindingClass(i.getNodeByPath(t,this._refPath),e)),Promise.resolve()},t}()},function(t,e){"use strict";function n(t,e){for(var n=t,r=0,i=e.length;r<i;r++)n=n.childNodes[e[r]];return n}function r(t){for(var e=[],n=t.parentNode,r=t;n;)for(e.unshift(Array.prototype.indexOf.call(n.childNodes,r)),r=n,n=n.parentNode;n&&n.nodeType>12;)n=n.parentNode;return e}e.getNodeByPath=n,e.getNodePath=r},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,n,r){for(var i in n){var o=e.attributes.get(i),s=new o(t,i,n[i],r);s.update&&r.bindings.push(s)}}var o=n(7),s=n(8),u=n(9),a=function(){function t(e,n,i){r(this,t),this.nodeType=1,this.tagName=String(e).toLocaleLowerCase(),this.childNodes=i,this.attributes=n||{};for(var o=0;o<i.length;o++)i[o].parentNode=this}return t.prototype.render=function(t,e){var n=t.components;return n.has(this.tagName)?this._renderComponent(n.get(this.tagName),t,e):this._renderElement(t,e)},t.prototype.setAttributes=function(t,e){"string"==typeof t?this.attributes[t]=e:o.extend(this.attributes,t)},t.prototype._renderComponent=function(t,e,n){var r=new s.FragmentSection(e.document);return n.push(new c(t,r,this,this._splitAttributes(e),e)),Promise.resolve(r.render())},t.prototype._renderElement=function(t,e){var n=t.document.createElement(this.tagName),r=this._splitAttributes(t);for(var i in r.staticAttributes)n.setAttribute(i,r.staticAttributes[i]);var o=this.childNodes.map(function(n){return n.render(t,e)});return Promise.all(o).then(function(i){return i.forEach(function(t){n.appendChild(t)}),Object.keys(r.dynamicAttributes).length&&e.push(new l(new u.NodeSection(t.document,n),t,r.dynamicAttributes)),n})},t.prototype._splitAttributes=function(t){var e={},n={};if(t.attributes)for(var r in this.attributes){var i=t.attributes.get(r);!i||i.test&&!i.test(this,r,this.attributes[r])?n[r]=this.attributes[r]:e[r]=this.attributes[r]}else n=this.attributes;return{dynamicAttributes:e,staticAttributes:n}},t}();e.Element=a,e.element=function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return new a(t,e,r)};var c=function(){function t(e,n,i,o,s){r(this,t),this.section=n,this.componentClass=e,this.element=i,this.options=s,this.attributes=o.staticAttributes,this.dynamicAttributes=o.dynamicAttributes}return t.prototype.generate=function(t,e){this._marker||(this._marker=this.section.createMarker());var n=new this.componentClass(this._marker.createSection(t),this.element,this.attributes,e);return Object.keys(this.dynamicAttributes).length&&i(n,this.options,this.dynamicAttributes,e),n.update&&e.bindings.push(n),n.initialize()},t}(),l=function(){function t(e,n,i){r(this,t),this.section=e,this.options=n,this.attributes=i}return t.prototype.generate=function(t,e){return this._marker||(this._marker=this.section.createMarker()),i(this._marker.findNode(t),this.options,this.attributes,e),Promise.resolve()},t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){for(var e=void 0,n=void 0,r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(var s=i,u=Array.isArray(s),a=0,s=u?s:s[Symbol.iterator]();;){if(u){if(a>=s.length)break;e=s[a++]}else{if(a=s.next(),a.done)break;e=a.value}if(e===Object(e))for(n in e)t[n]=e[n]}return t}function i(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Array.prototype.slice.apply(t,n)}function o(t,e,n){var i;i=e&&Object.prototype.hasOwnProperty.call(e,"constructor")?e.constructor:function(){return t.apply(this,arguments)},r(i,t,n);var o=function(){this.constructor=i};return o.prototype=t.prototype,i.prototype=new o,e&&r(i.prototype,e),i.__super__=t.prototype,i}function s(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];if("function"!=typeof t)throw new Error("method not at function");if(null!=c)return c.call.apply(c,[t,e].concat(r));r=r||[];var s=function(){},u=function(){var n=this instanceof s?this:e;return t.apply(n,r.concat(i(arguments)))};return s.prototype=this.prototype,u.prototype=new s,u}function u(t){return l.create(t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};e.extend=r,e.slice=i,e.extendClass=o;var c=Function.prototype.bind;e.bind=s;var l=function(){function t(e){n(this,t),this.enabled=!1,this.namespace=e}return t.enable=function(t,e){for(var n in this.loggers)e&&n===e?this.loggers[n].enabled=t:e||(this.loggers[n].enabled=t)},t.create=function(e){var n=void 0;return this.loggers[e]?n=this.loggers[e]:(n=new t(e),this.loggers[e]=n),s(n.debug,n)},t.prototype.debug=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];if(this.enabled){n[0]=this._coerce(n[0]),"string"!=typeof n[0]&&(n=["%o"].concat(n));var i=0;n[0]=n[0].replace(/%([a-z%])/g,function(e,r){if("%%"===e)return e;i++;var o=t.formatters[r];if("function"==typeof o){var s=n[i];e=o.call(self,s),n.splice(i,1),i--}return e}),n=this._formatArgs(n),this._log.apply(this,n)}},t.prototype._log=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return"object"===("undefined"==typeof console?"undefined":a(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.prototype._coerce=function(t){return t instanceof Error?t.stack||t.message:t},t.prototype._formatArgs=function(t){return t[0]="[templ:"+this.namespace+"] "+t[0],t},t}();l.loggers={},l.formatters={j:function(t){return JSON.stringify(t)}},e.Debug=l,e.debug=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(5),o=function(){function t(e,n,i){if(r(this,t),this.document=e,this.start=n||e.createTextNode(""),this.end=i||e.createTextNode(""),!this.start.parentNode){var o=e.createDocumentFragment();o.appendChild(this.start),o.appendChild(this.end),this.__parent=o}}return t.prototype.appendChild=function(t){this.end.parentNode.insertBefore(t,this.end)},t.prototype.render=function(){return this.start.parentNode},t.prototype.remove=function(){var t=this.removeChildNodes();return t.insertBefore(this.start,t.childNodes[0]),t.appendChild(this.end),this},t.prototype.removeChildNodes=function(){for(var t=this.document.createDocumentFragment(),e=this.start,n=e.nextSibling,r=this.end;n!==r;)t.appendChild(n),n=e.nextSibling;return t},t.prototype.createMarker=function(){return new s(this.document,i.getNodePath(this.start),i.getNodePath(this.end))},t.prototype.clone=function(){var e;if(11===this.start.parentNode.nodeType)e=this.start.parentNode.cloneNode(!0);else{e=this.document.createDocumentFragment();for(var n=this._getChildNodes(),r=n.length,i=0;i<r;i++)e.appendChild(n[i].cloneNode(!0))}var o=e.childNodes[0],s=e.childNodes[e.childNodes.length-1];return new t(this.document,o,s)},t.prototype._getChildNodes=function(){for(var t=this.start,e=this.end.nextSibling,n=[];t!==e;)n.push(t),t=t.nextSibling;return n},t}();e.FragmentSection=o;var s=function(){function t(e,n,i){r(this,t),this.document=e,this.startPath=n,this.endPath=i}return t.prototype.createSection=function(t){return new o(this.document,i.getNodeByPath(t,this.startPath),i.getNodeByPath(t,this.endPath))},t}();e.FragmentSectionMarker=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(5),o=function(){function t(e,n){r(this,t),this.document=e,this.node=n}return t.prototype.createMarker=function(){return new s(this.document,i.getNodePath(this.node))},t.prototype.appendChild=function(t){this.node.appendChild(t)},t.prototype.render=function(){return this.node},t.prototype.remove=function(){this.node.parentNode&&this.node.parentNode.removeChild(this.node)},t.prototype.removeChildren=function(){for(;this.node.childNodes.length;)this.node.removeChild(this.node.childNodes[0])},t.prototype.clone=function(){return new t(this.document,this.node.cloneNode(!0))},t}();e.NodeSection=o;var s=function(){function t(e,n){r(this,t),this.document=e,this.path=n}return t.prototype.createSection=function(t){return new o(this.document,this.findNode(t))},t.prototype.findNode=function(t){return i.getNodeByPath(t,this.path)},t}();e.NodeSectionMarker=s},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(e){o(e)}}function u(t){try{a(r["throw"](t))}catch(e){o(e)}}function a(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,u)}a((r=r.apply(t,e)).next())})},i=function(){function t(e){n(this,t),this.nodeType=11,this.childNodes=e;for(var r=0;r<e.length;r++)e[r].parentNode=this}return t.prototype.render=function(t,e){return r(this,void 0,Promise,regeneratorRuntime.mark(function n(){var r,i,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=t.document.createDocumentFragment(),i=0,o=this.childNodes.length;case 2:if(!(i<o)){n.next=10;break}return n.next=5,this.childNodes[i].render(t,e);case 5:s=n.sent,r.appendChild(s);case 7:i++,n.next=2;break;case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n,this)}))},t}();e.Fragment=i,e.fragment=function(t){return new i(t)}},function(t,e,n){"use strict";function r(t,e){var n=void 0;if(11==e.nodeType){var r=new i.FragmentSection(t);r.appendChild(e),n=r}else n=new o.NodeSection(t,e);return n}var i=n(8),o=n(9);e.section=r},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return new a(t,e)}var o=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(e){o(e)}}function u(t){try{a(r["throw"](t))}catch(e){o(e)}}function a(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,u)}a((r=r.apply(t,e)).next())})},s=n(11),u=n(13),a=function(){function t(e,n){r(this,t),this._renderers=[],this.vnode=e,this.options=n}return t.prototype.render=function(t,e){var n=this;return this.vnode.render(this.options,this._renderers).then(function(r){return n.section=s.section(n.options.document,r),n.view(t,e)})},t.prototype.view=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return o(this,void 0,Promise,regeneratorRuntime.mark(function n(){var r,i,o,s,a,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=this.section){n.next=2;break}throw new Error("must call render before view");case 2:r=this.section.clone(),i=this.options.viewClass||u.View;for(o in this.options)e[o]||(e[o]=this.options[o]);s=new i(r,this,t,e),a=0,c=this._renderers.length;case 7:if(!(a<c)){n.next=13;break}return n.next=10,this._renderers[a].generate(r.node||r.start.parentNode,s);case 10:a++,n.next=7;break;case 13:return n.abrupt("return",s);case 14:case"end":return n.stop()}},n,this)}))},t}();e.Template=a,e.template=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(14),u=function(t){function e(n,o,s,u){r(this,e);var a=i(this,t.call(this));return a.section=n,a.template=o,a.bindings=[],a._runloop=u.runloop,a.context=s,a}return o(e,t),e.prototype.update=function(){return Promise.all(this.bindings.map(function(t){return t.update()})).then(function(t){})},e.prototype.addListener=function(t,e,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];return t.addEventListener(e,n,r),n},e.prototype.removeListener=function(t,e,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];t.removeEventListener(e,n,r)},e.prototype.render=function(){return Promise.resolve(this.section.render())},e.prototype.remove=function(){for(var t=this.bindings,e=Array.isArray(t),n=0,t=e?t:t[Symbol.iterator]();;){var r;if(e){if(n>=t.length)break;r=t[n++]}else{if(n=t.next(),n.done)break;r=n.value}var i=r;i.destroy()}return this.section.remove()},e}(s.EventEmitter);e.View=u},function(t,e){"use strict";function n(){return""+ ++s}function r(t,e){void 0===e&&(e=[]);var n=t.length,r=-1,i=e[0],o=e[1],s=e[2],u=e[3];switch(e.length){case 0:for(;++r<n;)t[r].handler.call(t[r].ctx);return;case 1:for(;++r<n;)t[r].handler.call(t[r].ctx,i);return;case 2:for(;++r<n;)t[r].handler.call(t[r].ctx,i,o);return;case 3:for(;++r<n;)t[r].handler.call(t[r].ctx,i,o,s);return;case 4:for(;++r<n;)t[r].handler.call(t[r].ctx,i,o,s,u);return;default:for(;++r<n;)t[r].handler.apply(t[r].ctx,e);return}}function i(t){return"function"==typeof t}function o(t){return t instanceof u||i(t.on)&&i(t.off)&&i(t.trigger)}var s=0;e.callFunc=r,e.isFunction=i,e.isEventEmitter=o;var u=function(){function t(){}return Object.defineProperty(t.prototype,"listeners",{get:function(){return this._listeners},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){void 0===r&&(r=!1);var i=(this._listeners||(this._listeners={}))[t]||(this._listeners[t]=[]);return i.push({name:t,once:r,handler:e,ctx:n||this}),this},t.prototype.once=function(t,e,n){return this.on(t,e,n,!0)},t.prototype.off=function(t,e){if(this._listeners=this._listeners||{},null==t)this._listeners={};else if(this._listeners[t]){var n=this._listeners[t];if(null==e)this._listeners[t]=[];else for(var r=0;r<n.length;r++){n[r];n[r].handler==e&&this._listeners[t].splice(r,1)}}},t.prototype.trigger=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];this._listeners=this._listeners||{};var o=(this._listeners[e]||[]).concat(this._listeners.all||[]);t.debugCallback&&t.debugCallback(this.constructor.name,this.name,e,n,o);for(var s,u,a,c=(o.length,[]),l=0,f=o.length;l<f;l++)s=o[l],u=n,"all"==s.name?(u=[e].concat(n),r([s],u)):c.push(s),s.once===!0&&(a=this._listeners[s.name].indexOf(s),this._listeners[s.name].splice(a,1));return c.length&&this._executeListener(c,n),this},t.prototype._executeListener=function(t,e){var n=r;this.constructor.executeListenerFunction&&(n=this.constructor.executeListenerFunction),n(t,e)},t.prototype.listenTo=function(t,e,r,i,o){void 0===o&&(o=!1);var s,u,a;return s=this._listeningTo||(this._listeningTo={}),u=t.listenId||(t.listenId=n()),s[u]=t,a=o?"once":"on",t[a](e,r,this),this},t.prototype.listenToOnce=function(t,e,n,r){return this.listenTo(t,e,n,r,!0)},t.prototype.stopListening=function(t,e,n){var r=this._listeningTo;if(!r)return this;var i=!e&&!n;n||"object"!=typeof e||(n=this),t&&((r={})[t.listenId]=t);for(var o in r)t=r[o],t.off(e,n,this),!i&&Object.keys(t.listeners).length||delete this._listeningTo[o];return this},t.prototype.destroy=function(){this.stopListening(),this.off()},t}();e.EventEmitter=u},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){n(this,t),this.nodeType=-201,this.nodeValue=e}return t.prototype.render=function(t){return Promise.resolve(t.document.createTextNode(this.nodeValue))},t}();e.Text=r,e.text=function(t){return new r(t)}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}r(n(17)),r(n(18))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(12),o=n(10),s=function(){function t(e,n,s,u){r(this,t),this.section=e,this.vnode=n,this.attributes=s,this.view=u,this.document=u.template.options.document,n.childNodes&&(this.childTemplate=i.template(o.fragment(n.childNodes),u.template.options));for(var a in s)this.setAttribute(a,s[a])}return t.prototype.initialize=function(){return Promise.resolve()},t.prototype.setAttribute=function(t,e){this.attributes[t]=e},t.prototype.removeAttribute=function(t){this.attributes[t]=void 0},t.prototype.destroy=function(){},t}();e.BaseComponent=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){if(t)if(t.forEach)t.forEach(e);else for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)}var u=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(e){o(e)}}function u(t){try{a(r["throw"](t))}catch(e){o(e)}}function a(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,u)}a((r=r.apply(t,e)).next())})},a=n(17),c=n(19),l=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];var u=i(this,t.call.apply(t,[this].concat(o)));return u._children=[],u}return o(e,t),e.prototype.initialize=function(){return u(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.childTemplate.render({},{});case 2:case"end":return t.stop()}},t,this)}))},e.prototype.update=function(){return u(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,r,i,o,s,u,a,l,f,p,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.as,n=this.each,r=this.key||"key",i=0,o=this,s=this.view,n instanceof c.Call&&(n=n.call()),null!=n){t.next=9;break}return t.abrupt("return");case 9:a=[],l=0,f=n.length;case 11:if(!(l<f)){t.next=31;break}if(p=n[l],e?(u={},u[r]=l,u[e]=p):u=p,u.parent=o.view.context,!(i>=o._children.length)){t.next=24;break}return t.next=18,this.childTemplate.view(u,{parent:s});case 18:h=t.sent,o._children.push(h),o.section.appendChild(h.section.render()),a.push(h.render(u)),t.next=27;break;case 24:h=o._children[i],h.context=u,h.update();case 27:i++;case 28:l++,t.next=11;break;case 31:return this._children.splice(i).forEach(function(t){t.remove()}),t.next=34,a;case 34:case"end":return t.stop()}},t,this)}))},e.prototype.update2=function(){var t,e=this.as,n=this.each,r=this.key||"key",i=0,o=this,u=this.view;n instanceof c.Call&&(n=n.call()),console.log(n),s(n,function(n,s){var a;e?(t={},t[r]=s,t[e]=n):t=n,t.parent=o.view.context,i>=o._children.length?(a=o.childTemplate.view(t,{parent:u}),o._children.push(a),o.section.appendChild(a.render(t))):(a=o._children[i],a.context=t,a.update()),i++}),this._children.splice(i).forEach(function(t){t.remove()})},e.prototype.setAttribute=function(t,e){this[t]=e},e}(a.BaseComponent);e.Repeat=l,e.repeat=l},function(t,e,n){"use strict";function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e,n){for(var r,i="string"==typeof e?e.split("."):e,o=t,s=0,u=i.length-1;s<u;s++)r=i[s],o[r]||(o[r]={}),o=o[r];return o[i[i.length-1]]=n,n}var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(7),c=n(2),l=a.debug("view"),f=function(){function t(e,n,r,i){o(this,t),this.gettable=r,this.settable=i,this.view=e,this.path=n}return t.prototype.value=function(t){return 0===arguments.length?this.gettable?this.view.get(this.path):void 0:void(this.settable&&this.view.set(this.path,t))},t.prototype.toString=function(){return this.view.get(this.path)||""},t}();e.Reference=f;var p=function(){function t(e,n,r){o(this,t),this.view=e,this.path=n,this.value=r,this.assign=a.bind(this.assign,this),this.toString=a.bind(this.toString,this)}return t.prototype.assign=function(){this.view.set(this.path,this.value.call(this))},t.prototype.toString=function(){var t=this.value.call(this);return t?String(t):""},t}();e.Assignment=p;var h=function(){function t(e,n,r){o(this,t),this.view=e,this.keypath=n,this.params=r||[]}return t.prototype.call=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];e=e||[];var r=this.view.get(this.keypath);return null==r||"function"!=typeof r?this.view.trigger("error",this,new Error("function does not exists or is not a function")):r.apply(this.view,this.params.concat(e))},t.prototype.toString=function(){var t=this.call();return t?String(t):""},t}();e.Call=h;var d=function(t){function e(n,i,s){var u=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];o(this,e);var a=r(this,t.call(this,n,i,s,u));return a.context=s,a._callers={},a._getters={},u.parent&&(a.parent=u.parent),u.delegator&&(a._delegator=u.delegator),a}return i(e,t),e.prototype.getDelegator=function(){if(this._delegator)return this._delegator;for(var t=this.parent;void 0!=t;){if(t._delegator)return t._delegator;t=t.parent}return null},e.prototype.addListener=function(e,n,r){var i=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],o=this.getDelegator();return o?o.addListener(e,n,r,i):"function"==typeof r?t.prototype.addListener.call(this,e,n,r,i):void 0},e.prototype.removeListener=function(e,n,r){var i=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],o=this.getDelegator();o?o.removeListener(e,n,r,i):"function"==typeof r&&t.prototype.removeListener.call(this,e,n,r,i)},e.prototype.get=function(t){if(this.context){var e,n="string"!=typeof t?t.join("."):t;try{var r;(r=this._getters[n])||(r=this._getters[n]=new Function("return this."+n)),e=r.call(this.context)}catch(i){e=void 0}return e=void 0!=e?e:this.parent?this.parent.get(t):void 0,l('get value "%s": %s',t,e),e}},e.prototype.set=function(t,e){if(l("set value %s on context %j",e,this.context),this.context){"string"==typeof t&&(t=t.split("."));s(this.context,t,e);this.updateLater()}},e.prototype.render=function(){var e=this;return t.prototype.render.call(this).then(function(t){return e.update()}).then(function(){return e.section.render()})},e.prototype.updateLater=function(){this._runloop.deferOnce(this)},e.prototype.ref=function(t,e,n){return l("reference %s, gettable: %o, settabble: %o",t,e,n),new f(this,t,e,n)},e.prototype.assign=function(t,e){return l("assignment %s %s",t,e),new p(this,t,e)},e.prototype.call=function(t,e){var n;if(l('call keypath "%s", args: "%o"',t,e),"string"!=typeof t&&(t=t.join(".")),!(n=this._callers[t])){var r=["this"].concat(t.split("."));r.pop(),n=this._callers[t]=new Function("params","return this."+t+".apply("+r.join(".")+", params);")}return new h(this,t,e)},u(e,[{key:"root",get:function(){if(null==this.parent)return this;for(var t=this,e=t;e;)e=e.parent,e&&(t=e);return t}}]),e}(c.View);e.View=d},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}var i=n(21),o=n(23),s=n(24),u=n(25);r(n(22)),e.value=i.ValueAttribute,e.onclick=o.ClickAttribute,e.onenter=o.OnEnterAttribute,e.onescape=o.OnEscapeAttribute,e.onchange=o.ChangeAttribute,e.onscroll=o.ScrollAttribute,e.onfocus=o.OnFocusAttribute,e.onblur=o.BlurAttribute,e.checked=i.ValueAttribute,e.style=s.StyleAttribute,e.focus=u.FocusAttribute},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(22),u=n(19),a=n(7),c=["change","keyup","input"],l=function(t){function e(){return r(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype.initialize=function(){this._onInput=a.bind(this._onInput,this,null);for(var t=c,e=Array.isArray(t),n=0,t=e?t:t[Symbol.iterator]();;){var r;if(e){if(n>=t.length)break;r=t[n++]}else{if(n=t.next(),n.done)break;r=n.value}var i=r;this.ref.addEventListener(i,this._onInput)}},e.prototype.update=function(){var t=this.model=this.value;return t?t&&t instanceof u.Reference?(t.gettable&&this._elementValue(this._parseValue(t.value())),Promise.resolve()):Promise.reject(new Error("input value must be a reference. Make sure you have <~> defined")):Promise.resolve()},e.prototype._parseValue=function(t){if(null!=t&&""!==t)return t},e.prototype._onInput=function(t){clearInterval(this._autocompleteCheckInterval),!t||t.keyCode&&~[27].indexOf(t.keyCode)||t.stopPropagation();var e=this._parseValue(this._elementValue());this.model&&String(this.model.value())!=String(e)&&this.model.value(e)},e.prototype._elementValue=function(t){var e=this.ref,n=/checkbox/.test(e.type),r=/radio/.test(e.type),i=n||r,o=Object.prototype.hasOwnProperty.call(e,"value"),s=o||/input|textarea|checkbox/.test(e.nodeName.toLowerCase()),u=/select/i.test(e.nodeName);return arguments.length?(null==t?t="":clearInterval(this._autocompleteCheckInterval),void(i?r?String(t)===String(e.value)&&(e.checked=!0):e.checked=t:String(t)!==this._elementValue()&&(s||u?e.value=t:e.innerHTML=t))):n?Boolean(e.checked):s||u?e.value||"":e.innerHTML||""},e}(s.BaseAttribute);e.ValueAttribute=l},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,r,i,o){n(this,t),this.ref=e,this.key=r,this.value=i,this.view=o,this.initialize()}return t.prototype.initialize=function(){},t.prototype.update=function(){return Promise.resolve()},t.prototype.destroy=function(){},t.test=function(){},t}();e.BaseAttribute=r},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(22),a=n(19),c=n(7),l=c.debug("attributes:event"),f=function(t){function e(){return r(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype.initialize=function(){this._onEvent=c.bind(this._onEvent,this)},e.prototype._onEvent=function(t){var e=void 0;if(e=this.value instanceof a.Assignment?this.value.assign:this.value,"function"!=typeof e&&!(e instanceof a.Call))throw new Error("[event] value is not a function or a Callable");if(l("fired event: %s",this._event),e instanceof a.Call)e.call();else if("function"==typeof e)return e(t);t.preventDefault()},e.prototype.destroy=function(){l("removed event listener %s: %o",this._event,this.value),this.view.removeListener(this.ref,this._event,this._onEvent)},s(e,[{key:"event",set:function(t){this._event&&(l("added event listener %s: %o",this._event,this.value),this.view.removeListener(this.ref,this._event,this._onEvent)),this._event=t,l("added event listener %s: %o",this._event,this.value),this.view.addListener(this.ref,this._event,this._onEvent);
},get:function(){return this._event}}]),e}(u.BaseAttribute);e.EventAttribute=f;var p=function(t){function e(n,o,s,u){r(this,e);var a=i(this,t.call(this,n,o,s,u));return a.keyCodes=[],a.event="keydown",a}return o(e,t),e.prototype._onEvent=function(e){~this.keyCodes.indexOf(e.keyCode)&&t.prototype._onEvent.call(this,e)},e}(f);e.KeyCodeAttribute=p;var h=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];var u=i(this,t.call.apply(t,[this].concat(o)));return u.event="change",u}return o(e,t),e}(f);e.ChangeAttribute=h;var d=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];var u=i(this,t.call.apply(t,[this].concat(o)));return u.event="click",u}return o(e,t),e}(f);e.ClickAttribute=d;var v=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];var u=i(this,t.call.apply(t,[this].concat(o)));return u.event="scroll",u}return o(e,t),e}(f);e.ScrollAttribute=v;var y=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];var u=i(this,t.call.apply(t,[this].concat(o)));return u.event="focus",u}return o(e,t),e}(f);e.OnFocusAttribute=y;var b=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];var u=i(this,t.call.apply(t,[this].concat(o)));return u.event="blur",u}return o(e,t),e}(f);e.BlurAttribute=b;var g=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];var u=i(this,t.call.apply(t,[this].concat(o)));return u.keyCodes=[13],u}return o(e,t),e}(p);e.OnEnterAttribute=g;var m=function(t){function e(){r(this,e);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];var u=i(this,t.call.apply(t,[this].concat(o)));return u.KeyCodes=[27],u}return o(e,t),e}(p);e.OnEscapeAttribute=m},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(22),u=function(t){function e(){return r(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype.initialize=function(){this._currentStyles={}},e.prototype.update=function(){var t=this.value;if("string"==typeof t)return this.ref.setAttribute("style",t),Promise.resolve();var e={};for(var n in t){var r=t[n];r!==this._currentStyles[n]&&(e[n]=this._currentStyles[n]=r||"")}for(var i in e)this.ref.style[i]=e[i];return Promise.resolve()},e}(s.BaseAttribute);e.StyleAttribute=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(22),u=function(t){function e(){return r(this,e),i(this,t.apply(this,arguments))}return o(e,t),e.prototype.initialize=function(){},e.prototype.update=function(){if(!this.value)return Promise.resolve();if(this.ref.focus){var t=this;setTimeout(function(){t.ref.focus()},1)}return Promise.resolve()},e}(s.BaseAttribute);e.FocusAttribute=u},function(t,e){"use strict";function n(t){return String(t).toUpperCase()}function r(t){return String(t).toLowerCase()}function i(t){var e;return e=String(t),e.substr(0,1).toUpperCase()+e.substr(1)}function o(t,e,n){return JSON.stringify.apply(JSON,arguments)}function s(t){return s(t)}e.uppercase=n,e.lowercase=r,e.titlecase=i,e.json=o,e.isNaN=s,e.round=Math.round},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){var n=o(t);return new Function("return "+n)()}function o(t){var e=new a;return e.transpile(t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},u=n(28);e.compile=i,e.transpile=o;var a=function(){function t(){r(this,t);for(var e in this)"_"===e.charAt(0)&&(this[e]=this[e].bind(this));this.transpile=this.transpile.bind(this)}return t.prototype.transpile=function(t){return this._root(u.parser.parse(t))},t.prototype._root=function(t){var e="(function(fragment, element, text, comment, dynamic, createBindingClass) {",n="fragment(["+this._children(t)+"])";return e+="'use strict';return "+n,e+="})"},t.prototype._expression=function(t){return this["_"+t[0]](t)},t.prototype._element=function(t){var e={},n=[];return t[2].forEach(function(r,i){var o=r[1],s=r[2],u=o.split(".");u.length>1?(e[u[0]]||(t=e[u[0]]=["element",u[0],[],[["element",t[1],n,t[3]]]]),e[u[0]][2].push([r[0],u[1],s])):n.push(r)}),this._element2(t)},t.prototype._doctype=function(t){return"text('<!DOCTYPE "+t[1]+">')"},t.prototype._children=function(t){for(t=t.concat();t.length;){var e=t[t.length-1];if("text"!==e[0])break;if(e[1]=e[1].replace(/[\s\r\n\t]+$/,""),!/^[\s\r\n\t]*$/.test(e[1]))break;t.pop()}return t.map(this._expression).join(", ")},t.prototype._element2=function(t){var e="element('"+t[1]+"'",n=[];e+=", {";e+=t[2].map(function(t){var e=t[1],r=t[2];return!r.length||1===r.length&&"string"===r[0][0]?"'"+e+"':"+(r.length?this._expression(r[0]):"true"):void n.push(t)}.bind(this)).filter(function(t){return!!t}).join(","),e+="}";var r=this._children(t[3]);if(r.length&&(e+=", "+r),e+=")",n.length){var i="",o="";n.forEach(function(t){var e=t[0];if(i+="this","block"===e)i+=".ref.nodeValue = "+this._expression(t[1]);else if("attribute"===e){var n=t[2].map(function(t){return"("+this._expression(t)+")"}.bind(this)).join("+");i+=".setAttribute('"+t[1]+"', "+n+");"}else"property"===e&&(i+=".setProperty('"+t[1]+"', "+this._expression(t[2])+");")}.bind(this)),i.length&&(i="function(context) {"+i+"}"),o.length&&(o="function() { var self = this; "+o+"}"),(i.length||o.length)&&(e="dynamic("+e+",",e+="createBindingClass("+(o.length?o:"void 0")+", "+(i?i:"void 0")+")",e+=")")}return e},t.prototype.__addReference=function(t){var e="_"+ ++this._refCounter;return this._refs[e]=t,e},t.prototype._block=function(t){var e="dynamic(text(), createBindingClass(void 0, function(context) {";return e+="this.ref.nodeValue = "+this._expression(t[1])+";",e+"}))"},t.prototype._text=function(t){return"text('"+t[1]+"')"},t.prototype._comment=function(t){return"comment('"+t[1]+"')"},t.prototype._hash=function(t){var e=t[1],n=[];for(var r in e)n.push("'"+r+"':"+this._expression(e[r]));return"{"+n.join(",")+"}"},t.prototype._script=function(t){return this._expression(t[1])},t.prototype._referenceKeyPath=function(t){var e=[],n=!1;return t.forEach(function(t){"string"!=typeof t?(n=!0,e.push(this._expression(t))):e.push(t)}.bind(this)),e=n?"["+e.map(function(e,n){return"string"==typeof t[n]?"'"+e+"'":e}).join(",")+"]":"'"+e.join(".")+"'"},t.prototype._reference=function(t){var e=this._referenceKeyPath(t[1]);if(t[2]){var n=!!~t[2].indexOf("<~"),r=!!~t[2].indexOf("~>");return"this.view.ref("+e+", "+n+", "+r+")"}return"this.view.get("+e+")"},t.prototype._string=function(t){return"'"+t[1]+"'"},t.prototype._operator=function(t){return this._expression(t[2])+t[1]+this._expression(t[3])},t.prototype._condition=function(t){return this._expression(t[1])+"?"+this._expression(t[2])+":"+this._expression(t[3])},t.prototype._literal=function(t){return t[1]},t.prototype._not=function(t){return"!"+this._expression(t[1])},t.prototype._negative=function(t){return"-"+this._expression(t[1])},t.prototype._call=function(t){var e="this.view.call("+this._referenceKeyPath(t[1][1])+", [";return e+=t[2].map(this._expression).join(","),e+"])"},t.prototype._modifier=function(t){return"this.options.modifiers."+t[1]+"("+t[2].map(this._expression).join(",")+")"},t.prototype._assign=function(t){return'this.view.assign("'+t[1][1]+'", function () { return '+this._expression(t[2])+";})"},t.prototype._group=function(t){return"("+this._expression(t[1])+")"},t.prototype.__findExpressions=function(t,e){var n=[];return this.__traverse(e,function(e){e[0]===t&&n.push(e)}),n},t.prototype.__traverse=function(t,e){e(t),t.forEach(function(t){t&&"object"===("undefined"==typeof t?"undefined":s(t))&&this.__traverse(t,e)}.bind(this))},t}()},function(t,e){"use strict";e.parser=function(){function t(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}function e(t,n,r,i){this.message=t,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}function n(t){function n(){return t.substring(Ei,ki)}function r(e){throw u(null,[{type:"other",description:e}],t.substring(Ei,ki),o(Ei,ki))}function i(e){var n,r,i=Ni[e];if(i)return i;for(n=e-1;!Ni[n];)n--;for(i=Ni[n],i={line:i.line,column:i.column,seenCR:i.seenCR};n<e;)r=t.charAt(n),"\n"===r?(i.seenCR||i.line++,i.column=1,i.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(i.line++,i.column=1,i.seenCR=!0):(i.column++,i.seenCR=!1),n++;return Ni[e]=i,i}function o(t,e){var n=i(t),r=i(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function s(t){ki<Oi||(ki>Oi&&(Oi=ki,Pi=[]),Pi.push(t))}function u(t,n,r,i){function o(t){var e=1;for(t.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}function s(t,e){function n(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+e(t)}).replace(/[\u0100-\u0FFF]/g,function(t){return"\\u0"+e(t)}).replace(/[\u1000-\uFFFF]/g,function(t){return"\\u"+e(t)})}var r,i,o,s=new Array(t.length);for(o=0;o<t.length;o++)s[o]=t[o].description;return r=t.length>1?s.slice(0,-1).join(", ")+" or "+s[t.length-1]:s[0],i=e?'"'+n(e)+'"':"end of input","Expected "+r+" but "+i+" found."}return null!==n&&o(n),new e(null!==t?t:s(n,r),n,r,i)}function a(){var t;return t=c()}function c(){var t,e;return t=ki,e=f(),e!==mt&&(Ei=t,e=At(e)),t=e}function l(){var e,n,r,i,o,u;if(e=ki,t.substr(ki,9)===Ct?(n=Ct,ki+=9):(n=mt,0===Si&&s(xt)),n!==mt)if(r=ft(),r!==mt){if(i=[],kt.test(t.charAt(ki))?(o=t.charAt(ki),ki++):(o=mt,0===Si&&s(Et)),o!==mt)for(;o!==mt;)i.push(o),kt.test(t.charAt(ki))?(o=t.charAt(ki),ki++):(o=mt,0===Si&&s(Et));else i=mt;i!==mt?(o=ft(),o!==mt?(62===t.charCodeAt(ki)?(u=Nt,ki++):(u=mt,0===Si&&s(Ot)),u!==mt?(Ei=e,n=Pt(i),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)}else ki=e,e=mt;else ki=e,e=mt;return e}function f(){var t,e,n;for(t=ki,e=[],n=v(),n===mt&&(n=h(),n===mt&&(n=b(),n===mt&&(n=p(),n===mt&&(n=g(),n===mt&&(n=P())))));n!==mt;)e.push(n),n=v(),n===mt&&(n=h(),n===mt&&(n=b(),n===mt&&(n=p(),n===mt&&(n=g(),n===mt&&(n=P())))));return e!==mt&&(Ei=t,e=St(e)),t=e}function p(){var e,n,r,i,o,u,a;if(e=ki,n=ft(),n!==mt)if(t.substr(ki,4)===jt?(r=jt,ki+=4):(r=mt,0===Si&&s(Tt)),r!==mt){if(i=[],o=ki,u=ki,Si++,t.substr(ki,3)===Rt?(a=Rt,ki+=3):(a=mt,0===Si&&s(Ft)),Si--,a===mt?u=void 0:(ki=u,u=mt),u!==mt?(a=lt(),a!==mt?(Ei=o,u=Lt(a),o=u):(ki=o,o=mt)):(ki=o,o=mt),o!==mt)for(;o!==mt;)i.push(o),o=ki,u=ki,Si++,t.substr(ki,3)===Rt?(a=Rt,ki+=3):(a=mt,0===Si&&s(Ft)),Si--,a===mt?u=void 0:(ki=u,u=mt),u!==mt?(a=lt(),a!==mt?(Ei=o,u=Lt(a),o=u):(ki=o,o=mt)):(ki=o,o=mt);else i=mt;i!==mt?(t.substr(ki,3)===Rt?(o=Rt,ki+=3):(o=mt,0===Si&&s(Ft)),o!==mt?(u=ft(),u!==mt?(Ei=e,n=Bt(i),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)}else ki=e,e=mt;else ki=e,e=mt;return e===mt&&(e=l()),e}function h(){var e,n,r,i,o,u,a,c;if(e=ki,n=ft(),n!==mt)if(t.substr(ki,7)===Vt?(r=Vt,ki+=7):(r=mt,0===Si&&s(zt)),r!==mt)if(i=C(),i!==mt)if(62===t.charCodeAt(ki)?(o=Nt,ki++):(o=mt,0===Si&&s(Ot)),o!==mt){if(u=[],a=d(),a!==mt)for(;a!==mt;)u.push(a),a=d();else u=mt;u!==mt?(t.substr(ki,9)===Dt?(a=Dt,ki+=9):(a=mt,0===Si&&s(It)),a!==mt?(c=ft(),c!==mt?(Ei=e,n=$t(i,u),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)}else ki=e,e=mt;else ki=e,e=mt;else ki=e,e=mt;else ki=e,e=mt;return e}function d(){var e,n,r;return e=ki,n=ki,Si++,t.substr(ki,9)===Dt?(r=Dt,ki+=9):(r=mt,0===Si&&s(It)),Si--,r===mt?n=void 0:(ki=n,n=mt),n!==mt?(r=lt(),r!==mt?(Ei=e,n=Mt(),e=n):(ki=e,e=mt)):(ki=e,e=mt),e}function v(){var e,n,r,i,o,u;return e=ki,60===t.charCodeAt(ki)?(n=qt,ki++):(n=mt,0===Si&&s(Ut)),n!==mt?(t.substr(ki,4)===Zt?(r=Zt,ki+=4):(r=mt,0===Si&&s(Kt)),r===mt&&(t.substr(ki,4)===Qt?(r=Qt,ki+=4):(r=mt,0===Si&&s(Yt)),r===mt&&(t.substr(ki,2)===Jt?(r=Jt,ki+=2):(r=mt,0===Si&&s(Ht)),r===mt&&(t.substr(ki,3)===Gt?(r=Gt,ki+=3):(r=mt,0===Si&&s(Wt)),r===mt&&(t.substr(ki,7)===Xt?(r=Xt,ki+=7):(r=mt,0===Si&&s(te)),r===mt&&(t.substr(ki,5)===ee?(r=ee,ki+=5):(r=mt,0===Si&&s(ne)),r===mt&&(t.substr(ki,2)===re?(r=re,ki+=2):(r=mt,0===Si&&s(ie)),r===mt&&(t.substr(ki,3)===oe?(r=oe,ki+=3):(r=mt,0===Si&&s(se)),r===mt&&(t.substr(ki,5)===ue?(r=ue,ki+=5):(r=mt,0===Si&&s(ae)),r===mt&&(t.substr(ki,6)===ce?(r=ce,ki+=6):(r=mt,0===Si&&s(le)),r===mt&&(t.substr(ki,4)===fe?(r=fe,ki+=4):(r=mt,0===Si&&s(pe)),r===mt&&(t.substr(ki,4)===he?(r=he,ki+=4):(r=mt,0===Si&&s(de)),r===mt&&(t.substr(ki,5)===ve?(r=ve,ki+=5):(r=mt,0===Si&&s(ye)),r===mt&&(t.substr(ki,6)===be?(r=be,ki+=6):(r=mt,0===Si&&s(ge)),r===mt&&(t.substr(ki,5)===me?(r=me,ki+=5):(r=mt,0===Si&&s(_e)),r===mt&&(t.substr(ki,3)===we?(r=we,ki+=3):(r=mt,0===Si&&s(Ae))))))))))))))))),r!==mt?(i=C(),i!==mt?(62===t.charCodeAt(ki)?(o=Nt,ki++):(o=mt,0===Si&&s(Ot)),o===mt&&(t.substr(ki,2)===Ce?(o=Ce,ki+=2):(o=mt,0===Si&&s(xe))),o===mt&&(o=null),o!==mt?(u=y(),u===mt&&(u=null),u!==mt?(Ei=e,n=ke(r,i,u),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function y(){var e,n,r,i,o;return e=ki,n=ft(),n!==mt?(t.substr(ki,2)===Ee?(r=Ee,ki+=2):(r=mt,0===Si&&s(Ne)),r!==mt?(t.substr(ki,4)===Zt?(i=Zt,ki+=4):(i=mt,0===Si&&s(Kt)),i===mt&&(t.substr(ki,4)===Qt?(i=Qt,ki+=4):(i=mt,0===Si&&s(Yt)),i===mt&&(t.substr(ki,2)===Jt?(i=Jt,ki+=2):(i=mt,0===Si&&s(Ht)),i===mt&&(t.substr(ki,3)===Gt?(i=Gt,ki+=3):(i=mt,0===Si&&s(Wt)),i===mt&&(t.substr(ki,7)===Xt?(i=Xt,ki+=7):(i=mt,0===Si&&s(te)),i===mt&&(t.substr(ki,5)===ee?(i=ee,ki+=5):(i=mt,0===Si&&s(ne)),i===mt&&(t.substr(ki,2)===re?(i=re,ki+=2):(i=mt,0===Si&&s(ie)),i===mt&&(t.substr(ki,3)===oe?(i=oe,ki+=3):(i=mt,0===Si&&s(se)),i===mt&&(t.substr(ki,5)===ue?(i=ue,ki+=5):(i=mt,0===Si&&s(ae)),i===mt&&(t.substr(ki,6)===ce?(i=ce,ki+=6):(i=mt,0===Si&&s(le)),i===mt&&(t.substr(ki,4)===fe?(i=fe,ki+=4):(i=mt,0===Si&&s(pe)),i===mt&&(t.substr(ki,4)===he?(i=he,ki+=4):(i=mt,0===Si&&s(de)),i===mt&&(t.substr(ki,5)===ve?(i=ve,ki+=5):(i=mt,0===Si&&s(ye)),i===mt&&(t.substr(ki,6)===be?(i=be,ki+=6):(i=mt,0===Si&&s(ge)),i===mt&&(t.substr(ki,5)===me?(i=me,ki+=5):(i=mt,0===Si&&s(_e)),i===mt&&(t.substr(ki,3)===we?(i=we,ki+=3):(i=mt,0===Si&&s(Ae))))))))))))))))),i!==mt?(62===t.charCodeAt(ki)?(o=Nt,ki++):(o=mt,0===Si&&s(Ot)),o!==mt?(Ei=e,n=Oe(i),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function b(){var t,e,n,r;return t=ki,e=_(),e!==mt?(n=f(),n!==mt?(r=x(),r!==mt?(Ei=t,e=Pe(e,n,r),t=e):(ki=t,t=mt)):(ki=t,t=mt)):(ki=t,t=mt),t===mt&&(t=w()),t}function g(){var t,e,n;if(t=ki,e=[],n=m(),n!==mt)for(;n!==mt;)e.push(n),n=m();else e=mt;return e!==mt&&(Ei=t,e=Se(e)),t=e}function m(){var e,n,r;return e=ki,n=ki,Si++,60===t.charCodeAt(ki)?(r=qt,ki++):(r=mt,0===Si&&s(Ut)),r===mt&&(t.substr(ki,2)===je?(r=je,ki+=2):(r=mt,0===Si&&s(Te))),Si--,r===mt?n=void 0:(ki=n,n=mt),n!==mt?(r=lt(),r!==mt?(Ei=e,n=Mt(),e=n):(ki=e,e=mt)):(ki=e,e=mt),e}function _(){var e,n,r,i,o,u;return e=ki,n=ft(),n!==mt?(60===t.charCodeAt(ki)?(r=qt,ki++):(r=mt,0===Si&&s(Ut)),r!==mt?(i=A(),i!==mt?(62===t.charCodeAt(ki)?(o=Nt,ki++):(o=mt,0===Si&&s(Ot)),o!==mt?(u=ft(),u!==mt?(Ei=e,n=Re(i),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function w(){var e,n,r,i,o,u;return e=ki,n=ft(),n!==mt?(60===t.charCodeAt(ki)?(r=qt,ki++):(r=mt,0===Si&&s(Ut)),r!==mt?(i=A(),i!==mt?(t.substr(ki,2)===Ce?(o=Ce,ki+=2):(o=mt,0===Si&&s(xe)),o!==mt?(u=ft(),u!==mt?(Ei=e,n=Fe(i),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function A(){var t,e,n;return t=ki,e=k(),e!==mt?(n=C(),n!==mt?(Ei=t,e=Le(e,n),t=e):(ki=t,t=mt)):(ki=t,t=mt),t}function C(){var t,e,n,r;if(t=ki,e=ft(),e!==mt){for(n=[],r=E();r!==mt;)n.push(r),r=E();n!==mt?(r=ft(),r!==mt?(Ei=t,e=Be(n),t=e):(ki=t,t=mt)):(ki=t,t=mt)}else ki=t,t=mt;return t}function x(){var e,n,r,i;return e=ki,t.substr(ki,2)===Ee?(n=Ee,ki+=2):(n=mt,0===Si&&s(Ne)),n!==mt?(r=k(),r!==mt?(62===t.charCodeAt(ki)?(i=Nt,ki++):(i=mt,0===Si&&s(Ot)),i!==mt?(Ei=e,n=Oe(r),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function k(){var e,n,r,i;if(e=ki,n=ft(),n!==mt){if(r=[],Ve.test(t.charAt(ki))?(i=t.charAt(ki),ki++):(i=mt,0===Si&&s(ze)),i!==mt)for(;i!==mt;)r.push(i),Ve.test(t.charAt(ki))?(i=t.charAt(ki),ki++):(i=mt,0===Si&&s(ze));else r=mt;r!==mt?(Ei=e,n=De(r),e=n):(ki=e,e=mt)}else ki=e,e=mt;return e}function E(){var e,n,r,i,o,u;return e=ki,n=k(),n!==mt?(r=ft(),r!==mt?(61===t.charCodeAt(ki)?(i=Ie,ki++):(i=mt,0===Si&&s($e)),i!==mt?(o=ft(),o!==mt?(u=N(),u!==mt?(Ei=e,n=Me(n,u),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(e=ki,n=k(),n!==mt?(r=ft(),r!==mt?(61===t.charCodeAt(ki)?(i=Ie,ki++):(i=mt,0===Si&&s($e)),i!==mt?(o=ft(),o!==mt?(u=O(),u!==mt?(Ei=e,n=qe(n,u),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(e=ki,n=k(),n!==mt&&(Ei=e,n=Ue(n)),e=n)),e}function N(){var e,n,r,i,o,u,a,c;if(e=ki,34===t.charCodeAt(ki)?(n=Ze,ki++):(n=mt,0===Si&&s(Ke)),n!==mt){if(r=[],i=O(),i===mt){if(i=ki,o=[],u=ki,a=ki,Si++,t.substr(ki,2)===je?(c=je,ki+=2):(c=mt,0===Si&&s(Te)),Si--,c===mt?a=void 0:(ki=a,a=mt),a!==mt?(Qe.test(t.charAt(ki))?(c=t.charAt(ki),ki++):(c=mt,0===Si&&s(Ye)),c!==mt?(a=[a,c],u=a):(ki=u,u=mt)):(ki=u,u=mt),u!==mt)for(;u!==mt;)o.push(u),u=ki,a=ki,Si++,t.substr(ki,2)===je?(c=je,ki+=2):(c=mt,0===Si&&s(Te)),Si--,c===mt?a=void 0:(ki=a,a=mt),a!==mt?(Qe.test(t.charAt(ki))?(c=t.charAt(ki),ki++):(c=mt,0===Si&&s(Ye)),c!==mt?(a=[a,c],u=a):(ki=u,u=mt)):(ki=u,u=mt);else o=mt;o!==mt&&(Ei=i,o=Je()),i=o}for(;i!==mt;)if(r.push(i),i=O(),i===mt){if(i=ki,o=[],u=ki,a=ki,Si++,t.substr(ki,2)===je?(c=je,ki+=2):(c=mt,0===Si&&s(Te)),Si--,c===mt?a=void 0:(ki=a,a=mt),a!==mt?(Qe.test(t.charAt(ki))?(c=t.charAt(ki),ki++):(c=mt,0===Si&&s(Ye)),c!==mt?(a=[a,c],u=a):(ki=u,u=mt)):(ki=u,u=mt),u!==mt)for(;u!==mt;)o.push(u),u=ki,a=ki,Si++,t.substr(ki,2)===je?(c=je,ki+=2):(c=mt,0===Si&&s(Te)),Si--,c===mt?a=void 0:(ki=a,a=mt),a!==mt?(Qe.test(t.charAt(ki))?(c=t.charAt(ki),ki++):(c=mt,0===Si&&s(Ye)),c!==mt?(a=[a,c],u=a):(ki=u,u=mt)):(ki=u,u=mt);else o=mt;o!==mt&&(Ei=i,o=Je()),i=o}r!==mt?(34===t.charCodeAt(ki)?(i=Ze,ki++):(i=mt,0===Si&&s(Ke)),i!==mt?(Ei=e,n=He(r),e=n):(ki=e,e=mt)):(ki=e,e=mt)}else ki=e,e=mt;if(e===mt)if(e=ki,39===t.charCodeAt(ki)?(n=Ge,ki++):(n=mt,0===Si&&s(We)),n!==mt){if(r=[],i=O(),i===mt){if(i=ki,o=[],u=ki,a=ki,Si++,t.substr(ki,2)===je?(c=je,ki+=2):(c=mt,0===Si&&s(Te)),Si--,c===mt?a=void 0:(ki=a,a=mt),a!==mt?(Xe.test(t.charAt(ki))?(c=t.charAt(ki),ki++):(c=mt,0===Si&&s(tn)),c!==mt?(a=[a,c],u=a):(ki=u,u=mt)):(ki=u,u=mt),u!==mt)for(;u!==mt;)o.push(u),u=ki,a=ki,Si++,t.substr(ki,2)===je?(c=je,ki+=2):(c=mt,0===Si&&s(Te)),Si--,c===mt?a=void 0:(ki=a,a=mt),a!==mt?(Xe.test(t.charAt(ki))?(c=t.charAt(ki),ki++):(c=mt,0===Si&&s(tn)),c!==mt?(a=[a,c],u=a):(ki=u,u=mt)):(ki=u,u=mt);else o=mt;o!==mt&&(Ei=i,o=Je()),i=o}for(;i!==mt;)if(r.push(i),i=O(),i===mt){if(i=ki,o=[],u=ki,a=ki,Si++,t.substr(ki,2)===je?(c=je,ki+=2):(c=mt,0===Si&&s(Te)),Si--,c===mt?a=void 0:(ki=a,a=mt),a!==mt?(Xe.test(t.charAt(ki))?(c=t.charAt(ki),ki++):(c=mt,0===Si&&s(tn)),c!==mt?(a=[a,c],u=a):(ki=u,u=mt)):(ki=u,u=mt),u!==mt)for(;u!==mt;)o.push(u),u=ki,a=ki,Si++,t.substr(ki,2)===je?(c=je,ki+=2):(c=mt,0===Si&&s(Te)),Si--,c===mt?a=void 0:(ki=a,a=mt),a!==mt?(Xe.test(t.charAt(ki))?(c=t.charAt(ki),ki++):(c=mt,0===Si&&s(tn)),c!==mt?(a=[a,c],u=a):(ki=u,u=mt)):(ki=u,u=mt);else o=mt;o!==mt&&(Ei=i,o=Je()),i=o}r!==mt?(39===t.charCodeAt(ki)?(i=Ge,ki++):(i=mt,0===Si&&s(We)),i!==mt?(Ei=e,n=He(r),e=n):(ki=e,e=mt)):(ki=e,e=mt)}else ki=e,e=mt;return e}function O(){var e,n,r,i,o,u;return e=ki,t.substr(ki,2)===je?(n=je,ki+=2):(n=mt,0===Si&&s(Te)),n!==mt?(r=ft(),r!==mt?(i=S(),i!==mt?(o=ft(),o!==mt?(t.substr(ki,2)===en?(u=en,ki+=2):(u=mt,0===Si&&s(nn)),u!==mt?(Ei=e,n=rn(i),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function P(){var t,e;return t=ki,e=O(),e!==mt&&(Ei=t,e=on(e)),t=e}function S(){var e,n,r,i,o,u;return e=ki,n=R(),n!==mt?(63===t.charCodeAt(ki)?(r=sn,ki++):(r=mt,0===Si&&s(un)),r!==mt?(i=S(),i!==mt?(58===t.charCodeAt(ki)?(o=an,ki++):(o=mt,0===Si&&s(cn)),o!==mt?(u=S(),u!==mt?(Ei=e,n=ln(n,i,u),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(e=R()),e}function j(){var e,n,r,i;return e=ki,40===t.charCodeAt(ki)?(n=fn,ki++):(n=mt,0===Si&&s(pn)),n!==mt?(r=T(),r!==mt?(41===t.charCodeAt(ki)?(i=hn,ki++):(i=mt,0===Si&&s(dn)),i!==mt?(Ei=e,n=vn(r),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(e=ki,t.substr(ki,2)===yn?(n=yn,ki+=2):(n=mt,0===Si&&s(bn)),n!==mt&&(Ei=e,n=gn()),e=n),e}function T(){var e,n,r,i,o,u;if(e=ki,n=S(),n!==mt){for(r=[],i=ki,44===t.charCodeAt(ki)?(o=mn,ki++):(o=mt,0===Si&&s(_n)),o!==mt?(u=S(),u!==mt?(o=[o,u],i=o):(ki=i,i=mt)):(ki=i,i=mt);i!==mt;)r.push(i),i=ki,44===t.charCodeAt(ki)?(o=mn,ki++):(o=mt,0===Si&&s(_n)),o!==mt?(u=S(),u!==mt?(o=[o,u],i=o):(ki=i,i=mt)):(ki=i,i=mt);r!==mt?(Ei=e,n=wn(n,r),e=n):(ki=e,e=mt)}else ki=e,e=mt;return e}function R(){var e,n,r,i;return e=ki,n=z(),n!==mt?(61===t.charCodeAt(ki)?(r=Ie,ki++):(r=mt,0===Si&&s($e)),r!==mt?(i=R(),i!==mt?(Ei=e,n=An(n,i),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(e=F()),e}function F(){var e,n,r,i;return e=ki,n=L(),n!==mt?(t.substr(ki,2)===Cn?(r=Cn,ki+=2):(r=mt,0===Si&&s(xn)),r===mt&&(t.substr(ki,2)===kn?(r=kn,ki+=2):(r=mt,0===Si&&s(En)),r===mt&&(t.substr(ki,3)===Nn?(r=Nn,ki+=3):(r=mt,0===Si&&s(On)),r===mt&&(t.substr(ki,2)===Pn?(r=Pn,ki+=2):(r=mt,0===Si&&s(Sn)),r===mt&&(t.substr(ki,3)===jn?(r=jn,ki+=3):(r=mt,0===Si&&s(Tn)),r===mt&&(t.substr(ki,2)===Rn?(r=Rn,ki+=2):(r=mt,0===Si&&s(Fn)),r===mt&&(t.substr(ki,3)===Ln?(r=Ln,ki+=3):(r=mt,0===Si&&s(Bn)),r===mt&&(t.substr(ki,2)===Vn?(r=Vn,ki+=2):(r=mt,0===Si&&s(zn)),r===mt&&(62===t.charCodeAt(ki)?(r=Nt,ki++):(r=mt,0===Si&&s(Ot)),r===mt&&(t.substr(ki,3)===Dn?(r=Dn,ki+=3):(r=mt,0===Si&&s(In)),r===mt&&(t.substr(ki,2)===$n?(r=$n,ki+=2):(r=mt,0===Si&&s(Mn)),r===mt&&(60===t.charCodeAt(ki)?(r=qt,ki++):(r=mt,0===Si&&s(Ut)),r===mt&&(43===t.charCodeAt(ki)?(r=qn,ki++):(r=mt,0===Si&&s(Un)),r===mt&&(45===t.charCodeAt(ki)?(r=Zn,ki++):(r=mt,0===Si&&s(Kn)),r===mt&&(37===t.charCodeAt(ki)?(r=Qn,ki++):(r=mt,0===Si&&s(Yn)),r===mt&&(42===t.charCodeAt(ki)?(r=Jn,ki++):(r=mt,0===Si&&s(Hn)),r===mt&&(47===t.charCodeAt(ki)?(r=Gn,ki++):(r=mt,0===Si&&s(Wn)))))))))))))))))),r!==mt?(i=F(),i!==mt?(Ei=e,n=Xn(n,r,i),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(e=L()),e}function L(){var t,e,n,r;return t=ki,e=ft(),e!==mt?(n=B(),n!==mt?(r=ft(),r!==mt?(Ei=t,e=tr(n),t=e):(ki=t,t=mt)):(ki=t,t=mt)):(ki=t,t=mt),t}function B(){var t,e,n,r;if(t=ki,e=D(),e!==mt){for(n=[],r=V();r!==mt;)n.push(r),r=V();n!==mt?(Ei=t,e=er(e,n),t=e):(ki=t,t=mt)}else ki=t,t=mt;return t===mt&&(t=H(),t===mt&&(t=z())),t}function V(){var e,n,r,i,o,u;return e=ki,124===t.charCodeAt(ki)?(n=nr,ki++):(n=mt,0===Si&&s(rr)),n!==mt?(r=ft(),r!==mt?(i=et(),i!==mt?(o=j(),o===mt&&(o=null),o!==mt?(u=ft(),u!==mt?(Ei=e,n=ir(i,o),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function z(){var t,e,n,r;return t=ki,e=ft(),e!==mt?(n=I(),n!==mt?(r=ft(),r!==mt?(Ei=t,e=or(n),t=e):(ki=t,t=mt)):(ki=t,t=mt)):(ki=t,t=mt),t}function D(){var e,n,r;return e=ki,33===t.charCodeAt(ki)?(n=sr,ki++):(n=mt,0===Si&&s(ur)),n!==mt?(r=D(),r!==mt?(Ei=e,n=ar(n,r),e=n):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(e=ki,33===t.charCodeAt(ki)?(n=sr,ki++):(n=mt,0===Si&&s(ur)),n===mt&&(45===t.charCodeAt(ki)?(n=Zn,ki++):(n=mt,0===Si&&s(Kn))),n!==mt?(r=D(),r!==mt?(Ei=e,n=cr(n,r),e=n):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(e=U(),e===mt&&(e=H(),e===mt&&(e=z())))),e}function I(){var t;return t=q(),t===mt&&(t=nt(),t===mt&&(t=$(),t===mt&&(t=ut(),t===mt&&(t=G())))),t}function $(){var e,n,r,i,o,u;if(e=ki,n=ki,45===t.charCodeAt(ki)?(r=Zn,ki++):(r=mt,0===Si&&s(Kn)),r===mt&&(r=null),r!==mt){if(i=ki,o=[],lr.test(t.charAt(ki))?(u=t.charAt(ki),ki++):(u=mt,0===Si&&s(fr)),u!==mt)for(;u!==mt;)o.push(u),lr.test(t.charAt(ki))?(u=t.charAt(ki),ki++):(u=mt,0===Si&&s(fr));else o=mt;o!==mt?(u=M(),u===mt&&(u=null),u!==mt?(o=[o,u],i=o):(ki=i,i=mt)):(ki=i,i=mt),i===mt&&(i=M()),i!==mt?(r=[r,i],n=r):(ki=n,n=mt)}else ki=n,n=mt;return n!==mt&&(Ei=e,n=pr(n)),e=n}function M(){var e,n,r,i;if(e=ki,46===t.charCodeAt(ki)?(n=hr,ki++):(n=mt,0===Si&&s(dr)),n!==mt){if(r=[],lr.test(t.charAt(ki))?(i=t.charAt(ki),ki++):(i=mt,0===Si&&s(fr)),i!==mt)for(;i!==mt;)r.push(i),lr.test(t.charAt(ki))?(i=t.charAt(ki),ki++):(i=mt,0===Si&&s(fr));else r=mt;r!==mt?(n=[n,r],e=n):(ki=e,e=mt)}else ki=e,e=mt;return e}function q(){var e,n,r,i;return e=ki,40===t.charCodeAt(ki)?(n=fn,ki++):(n=mt,0===Si&&s(pn)),n!==mt?(r=S(),r!==mt?(41===t.charCodeAt(ki)?(i=hn,ki++):(i=mt,0===Si&&s(dn)),i!==mt?(Ei=e,n=vr(r),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function U(){var t,e;return t=ki,e=Z(),e===mt&&(e=K(),e===mt&&(e=J(),e===mt&&(e=Q(),e===mt&&(e=Y())))),e!==mt&&(Ei=t,e=yr(e)),t=e}function Z(){var e,n;return e=ki,t.substr(ki,4)===br?(n=br,ki+=4):(n=mt,0===Si&&s(gr)),n===mt&&(t.substr(ki,5)===mr?(n=mr,ki+=5):(n=mt,0===Si&&s(_r))),n!==mt&&(Ei=e,n=wr(n)),e=n}function K(){var e,n;return e=ki,t.substr(ki,9)===Ar?(n=Ar,ki+=9):(n=mt,0===Si&&s(Cr)),n!==mt&&(Ei=e,n=xr()),e=n}function Q(){var e,n;return e=ki,t.substr(ki,3)===kr?(n=kr,ki+=3):(n=mt,0===Si&&s(Er)),n!==mt&&(Ei=e,n=Nr()),e=n}function Y(){var e,n;return e=ki,t.substr(ki,8)===Or?(n=Or,ki+=8):(n=mt,0===Si&&s(Pr)),n!==mt&&(Ei=e,n=Sr()),e=n}function J(){var e,n;return e=ki,t.substr(ki,4)===jr?(n=jr,ki+=4):(n=mt,0===Si&&s(Tr)),n===mt&&(t.substr(ki,4)===Rr?(n=Rr,ki+=4):(n=mt,0===Si&&s(Fr))),n!==mt&&(Ei=e,n=Lr()),e=n}function H(){var t,e,n;return t=ki,e=z(),e!==mt?(n=j(),n!==mt?(Ei=t,e=Br(e,n),t=e):(ki=t,t=mt)):(ki=t,t=mt),t}function G(){var e,n,r,i,o,u;if(e=ki,94===t.charCodeAt(ki)?(n=Vr,ki++):(n=mt,0===Si&&s(zr)),n===mt&&(t.substr(ki,2)===Dr?(n=Dr,ki+=2):(n=mt,0===Si&&s(Ir)),n===mt&&(t.substr(ki,3)===$r?(n=$r,ki+=3):(n=mt,0===Si&&s(Mr)),n===mt&&(126===t.charCodeAt(ki)?(n=qr,ki++):(n=mt,0===Si&&s(Ur)),n===mt&&(t.substr(ki,2)===Zr?(n=Zr,ki+=2):(n=mt,0===Si&&s(Kr)))))),n===mt&&(n=null),n!==mt)if(r=ft(),r!==mt)if(i=et(),i!==mt){for(o=[],u=W();u!==mt;)o.push(u),u=W();o!==mt?(u=ft(),u!==mt?(Ei=e,n=Qr(n,i,o),e=n):(ki=e,e=mt)):(ki=e,e=mt)}else ki=e,e=mt;else ki=e,e=mt;else ki=e,e=mt;return e}function W(){var t;return t=X(),t===mt&&(t=tt()),t}function X(){var e,n,r;return e=ki,46===t.charCodeAt(ki)?(n=hr,ki++):(n=mt,0===Si&&s(dr)),n!==mt?(r=et(),r!==mt?(Ei=e,n=Yr(r),e=n):(ki=e,e=mt)):(ki=e,e=mt),e}function tt(){var e,n,r,i;return e=ki,91===t.charCodeAt(ki)?(n=Jr,ki++):(n=mt,0===Si&&s(Hr)),n!==mt?(r=S(),r!==mt?(93===t.charCodeAt(ki)?(i=Gr,ki++):(i=mt,0===Si&&s(Wr)),i!==mt?(Ei=e,n=Xr(r),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function et(){var e,n,r;if(e=ki,n=[],ti.test(t.charAt(ki))?(r=t.charAt(ki),ki++):(r=mt,0===Si&&s(ei)),r!==mt)for(;r!==mt;)n.push(r),ti.test(t.charAt(ki))?(r=t.charAt(ki),ki++):(r=mt,0===Si&&s(ei));else n=mt;return n!==mt&&(Ei=e,n=ni(n)),e=n}function nt(){var e,n,r,i,o,u;return e=ki,123===t.charCodeAt(ki)?(n=ri,ki++):(n=mt,0===Si&&s(ii)),n!==mt?(r=ft(),r!==mt?(i=rt(),i===mt&&(i=null),i!==mt?(o=ft(),o!==mt?(125===t.charCodeAt(ki)?(u=oi,ki++):(u=mt,0===Si&&s(si)),u!==mt?(Ei=e,n=ui(i),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function rt(){var t,e;return t=ki,e=it(),e!==mt&&(Ei=t,e=ai(e)),t=e}function it(){var e,n,r,i,o,u;if(e=ki,n=ot(),n!==mt){for(r=[],i=ki,44===t.charCodeAt(ki)?(o=mn,ki++):(o=mt,0===Si&&s(_n)),o!==mt?(u=it(),u!==mt?(o=[o,u],i=o):(ki=i,i=mt)):(ki=i,i=mt);i!==mt;)r.push(i),i=ki,44===t.charCodeAt(ki)?(o=mn,ki++):(o=mt,0===Si&&s(_n)),o!==mt?(u=it(),u!==mt?(o=[o,u],i=o):(ki=i,i=mt)):(ki=i,i=mt);r!==mt?(Ei=e,n=ci(n,r),e=n):(ki=e,e=mt)}else ki=e,e=mt;return e}function ot(){var e,n,r,i,o,u;return e=ki,n=ft(),n!==mt?(r=st(),r!==mt?(i=ft(),i!==mt?(58===t.charCodeAt(ki)?(o=an,ki++):(o=mt,0===Si&&s(cn)),o!==mt?(u=S(),u===mt&&(u=null),u!==mt?(Ei=e,n=li(r,u),e=n):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt)):(ki=e,e=mt),e}function st(){var t,e;return t=ki,e=ut(),e!==mt&&(Ei=t,e=fi(e)),t=e,t===mt&&(t=ki,e=et(),e!==mt&&(Ei=t,e=pi(e)),t=e),t}function ut(){var e,n,r,i;if(Si++,e=ki,34===t.charCodeAt(ki)?(n=Ze,ki++):(n=mt,0===Si&&s(Ke)),n!==mt){for(r=[],i=at();i!==mt;)r.push(i),i=at();r!==mt?(34===t.charCodeAt(ki)?(i=Ze,ki++):(i=mt,0===Si&&s(Ke)),i!==mt?(Ei=e,n=di(r),e=n):(ki=e,e=mt)):(ki=e,e=mt)}else ki=e,e=mt;if(e===mt)if(e=ki,39===t.charCodeAt(ki)?(n=Ge,ki++):(n=mt,0===Si&&s(We)),n!==mt){for(r=[],i=ct();i!==mt;)r.push(i),i=ct();r!==mt?(39===t.charCodeAt(ki)?(i=Ge,ki++):(i=mt,0===Si&&s(We)),i!==mt?(Ei=e,n=di(r),e=n):(ki=e,e=mt)):(ki=e,e=mt)}else ki=e,e=mt;return Si--,e===mt&&(n=mt,0===Si&&s(hi)),e}function at(){var e,n,r;return e=ki,n=ki,Si++,34===t.charCodeAt(ki)?(r=Ze,ki++):(r=mt,0===Si&&s(Ke)),r===mt&&(92===t.charCodeAt(ki)?(r=vi,ki++):(r=mt,0===Si&&s(yi))),Si--,r===mt?n=void 0:(ki=n,n=mt),n!==mt?(r=lt(),r!==mt?(Ei=e,n=bi(),e=n):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(t.substr(ki,2)===gi?(e=gi,ki+=2):(e=mt,0===Si&&s(mi))),e}function ct(){var e,n,r;return e=ki,n=ki,Si++,39===t.charCodeAt(ki)?(r=Ge,ki++):(r=mt,0===Si&&s(We)),r===mt&&(92===t.charCodeAt(ki)?(r=vi,ki++):(r=mt,0===Si&&s(yi))),Si--,r===mt?n=void 0:(ki=n,n=mt),n!==mt?(r=lt(),r!==mt?(Ei=e,n=bi(),e=n):(ki=e,e=mt)):(ki=e,e=mt),e===mt&&(t.substr(ki,2)===_i?(e=_i,ki+=2):(e=mt,0===Si&&s(wi))),e}function lt(){var e;return t.length>ki?(e=t.charAt(ki),ki++):(e=mt,0===Si&&s(Ai)),e}function ft(){var e,n;for(e=[],Ci.test(t.charAt(ki))?(n=t.charAt(ki),ki++):(n=mt,0===Si&&s(xi));n!==mt;)e.push(n),Ci.test(t.charAt(ki))?(n=t.charAt(ki),ki++):(n=mt,0===Si&&s(xi));return e}function pt(t){return t.replace(/(^\s+)|(\s+$)/,"").replace(/[\r\n]/g,"\\n")}function ht(t){return t.replace(/[ \r\n\t]+/g," ")}function dt(t){return t=t.filter(function(t){return!/^[\n\t\r]+$/.test(t.value)}),1===t.length&&"string"===t[0].type?t[0]:t}function vt(t){function e(t){for(var e,n=t.length;n--&&(e=t[n],"textNode"==e.type&&!/\S/.test(e.value)&&!e.decoded);)t.splice(n,1);return t}return e(e(t.reverse()).reverse())}function yt(t){return t.replace(/[\n\r]+/g,"\\n").replace(/'/g,"\\'")}var bt,gt=arguments.length>1?arguments[1]:{},mt={},_t={Start:a},wt=a,At=function(t){return t},Ct="<!DOCTYPE",xt={type:"literal",value:"<!DOCTYPE",description:'"<!DOCTYPE"'},kt=/^[^>]/,Et={type:"class",value:"[^>]",description:"[^>]"},Nt=">",Ot={type:"literal",value:">",description:'">"'},Pt=function(t){return["doctype",t.join("")]},St=function(t){return vt(t)},jt="<!--",Tt={type:"literal",value:"<!--",description:'"<!--"'},Rt="-->",Ft={type:"literal",value:"-->",description:'"-->"'},Lt=function(t){return t},Bt=function(t){return["comment",yt(pt(t.join("")))]},Vt="<script",zt={type:"literal",value:"<script",description:'"<script"'},Dt="</script>",It={type:"literal",value:"</script>",
description:'"</script>"'},$t=function(t,e){return["element","script",t,[["text",yt(e.join(""))]]]},Mt=function(){return n()},qt="<",Ut={type:"literal",value:"<",description:'"<"'},Zt="area",Kt={type:"literal",value:"area",description:'"area"'},Qt="base",Yt={type:"literal",value:"base",description:'"base"'},Jt="br",Ht={type:"literal",value:"br",description:'"br"'},Gt="col",Wt={type:"literal",value:"col",description:'"col"'},Xt="command",te={type:"literal",value:"command",description:'"command"'},ee="embed",ne={type:"literal",value:"embed",description:'"embed"'},re="hr",ie={type:"literal",value:"hr",description:'"hr"'},oe="img",se={type:"literal",value:"img",description:'"img"'},ue="input",ae={type:"literal",value:"input",description:'"input"'},ce="keygen",le={type:"literal",value:"keygen",description:'"keygen"'},fe="link",pe={type:"literal",value:"link",description:'"link"'},he="meta",de={type:"literal",value:"meta",description:'"meta"'},ve="param",ye={type:"literal",value:"param",description:'"param"'},be="source",ge={type:"literal",value:"source",description:'"source"'},me="track",_e={type:"literal",value:"track",description:'"track"'},we="wbr",Ae={type:"literal",value:"wbr",description:'"wbr"'},Ce="/>",xe={type:"literal",value:"/>",description:'"/>"'},ke=function(t,e,n){return n&&t!=n.name&&r("</"+t+">"),["element",t,e,[]]},Ee="</",Ne={type:"literal",value:"</",description:'"</"'},Oe=function(t){return{name:t}},Pe=function(t,e,n){return t.name!=n.name&&r("</"+t.name+">"),["element",t.name,t.attributes,e]},Se=function(t){return["text",yt(ht(t.join("")))]},je="{{",Te={type:"literal",value:"{{",description:'"{{"'},Re=function(t){return t},Fe=function(t){return["element",t.name,t.attributes,[]]},Le=function(t,e){return{name:t,attributes:e}},Be=function(t){return t},Ve=/^[a-zA-Z0-9:_.\-]/,ze={type:"class",value:"[a-zA-Z0-9:_\\.\\-]",description:"[a-zA-Z0-9:_\\.\\-]"},De=function(t){return t.join("")},Ie="=",$e={type:"literal",value:"=",description:'"="'},Me=function(t,e){return["attribute",t,e]},qe=function(t,e){return["property",t,e]},Ue=function(t){return["attribute",t,[]]},Ze='"',Ke={type:"literal",value:'"',description:'"\\""'},Qe=/^[^"]/,Ye={type:"class",value:'[^"]',description:'[^"]'},Je=function(){return["string",n()]},He=function(t){return dt(t)},Ge="'",We={type:"literal",value:"'",description:'"\'"'},Xe=/^[^']/,tn={type:"class",value:"[^']",description:"[^']"},en="}}",nn={type:"literal",value:"}}",description:'"}}"'},rn=function(t){return["script",t]},on=function(t){return["block",t[1]]},sn="?",un={type:"literal",value:"?",description:'"?"'},an=":",cn={type:"literal",value:":",description:'":"'},ln=function(t,e,n){return["condition",t,e,n]},fn="(",pn={type:"literal",value:"(",description:'"("'},hn=")",dn={type:"literal",value:")",description:'")"'},vn=function(t){return t},yn="()",bn={type:"literal",value:"()",description:'"()"'},gn=function(){return[]},mn=",",_n={type:"literal",value:",",description:'","'},wn=function(t,e){return[t].concat(e.map(function(t){return t[1]}))},An=function(t,e){return["assign",t,e]},Cn="&&",xn={type:"literal",value:"&&",description:'"&&"'},kn="||",En={type:"literal",value:"||",description:'"||"'},Nn="===",On={type:"literal",value:"===",description:'"==="'},Pn="==",Sn={type:"literal",value:"==",description:'"=="'},jn="!==",Tn={type:"literal",value:"!==",description:'"!=="'},Rn="!=",Fn={type:"literal",value:"!=",description:'"!="'},Ln=">==",Bn={type:"literal",value:">==",description:'">=="'},Vn=">=",zn={type:"literal",value:">=",description:'">="'},Dn="<==",In={type:"literal",value:"<==",description:'"<=="'},$n="<=",Mn={type:"literal",value:"<=",description:'"<="'},qn="+",Un={type:"literal",value:"+",description:'"+"'},Zn="-",Kn={type:"literal",value:"-",description:'"-"'},Qn="%",Yn={type:"literal",value:"%",description:'"%"'},Jn="*",Hn={type:"literal",value:"*",description:'"*"'},Gn="/",Wn={type:"literal",value:"/",description:'"/"'},Xn=function(t,e,n){return["operator",e,t,n]},tr=function(t){return t},er=function(t,e){for(var n=0,r=e.length;n<r;n++)t=["modifier",e[n].name,[t].concat(e[n].parameters)];return t},nr="|",rr={type:"literal",value:"|",description:'"|"'},ir=function(t,e){return{name:t,parameters:e||[]}},or=function(t){return t},sr="!",ur={type:"literal",value:"!",description:'"!"'},ar=function(t,e){return["not",e]},cr=function(t,e){return["negative",e]},lr=/^[0-9]/,fr={type:"class",value:"[0-9]",description:"[0-9]"},pr=function(t){return["literal",parseFloat(n())]},hr=".",dr={type:"literal",value:".",description:'"."'},vr=function(t){return["group",t]},yr=function(t){return t},br="true",gr={type:"literal",value:"true",description:'"true"'},mr="false",_r={type:"literal",value:"false",description:'"false"'},wr=function(t){return["literal","true"===t]},Ar="undefined",Cr={type:"literal",value:"undefined",description:'"undefined"'},xr=function(){return["literal",void 0]},kr="NaN",Er={type:"literal",value:"NaN",description:'"NaN"'},Nr=function(){return["literal",NaN]},Or="Infinity",Pr={type:"literal",value:"Infinity",description:'"Infinity"'},Sr=function(){return["literal",1/0]},jr="null",Tr={type:"literal",value:"null",description:'"null"'},Rr="NULL",Fr={type:"literal",value:"NULL",description:'"NULL"'},Lr=function(){return["literal",null]},Br=function(t,e){return["call",t,e]},Vr="^",zr={type:"literal",value:"^",description:'"^"'},Dr="~>",Ir={type:"literal",value:"~>",description:'"~>"'},$r="<~>",Mr={type:"literal",value:"<~>",description:'"<~>"'},qr="~",Ur={type:"literal",value:"~",description:'"~"'},Zr="<~",Kr={type:"literal",value:"<~",description:'"<~"'},Qr=function(t,e,n){return["reference",[e].concat(n),t]},Yr=function(t){return t},Jr="[",Hr={type:"literal",value:"[",description:'"["'},Gr="]",Wr={type:"literal",value:"]",description:'"]"'},Xr=function(t){return t},ti=/^[a-zA-Z_$0-9]/,ei={type:"class",value:"[a-zA-Z_$0-9]",description:"[a-zA-Z_$0-9]"},ni=function(t){return n()},ri="{",ii={type:"literal",value:"{",description:'"{"'},oi="}",si={type:"literal",value:"}",description:'"}"'},ui=function(t){return["hash",t]},ai=function(t){for(var e={},n=0,r=t.length;n<r;n++)e[t[n].key]=t[n].value;return e},ci=function(t,e){return[t].concat(e.length?e[0][1]:[])},li=function(t,e){return{key:t,value:e}},fi=function(t){return t[1]},pi=function(t){return t},hi={type:"other",description:"string"},di=function(t){return["string",t.join("")]},vi="\\",yi={type:"literal",value:"\\",description:'"\\\\"'},bi=function(){return n()},gi='\\"',mi={type:"literal",value:'\\"',description:'"\\\\\\""'},_i="\\'",wi={type:"literal",value:"\\'",description:'"\\\\\'"'},Ai={type:"any",description:"any character"},Ci=/^[ \n\r\t]/,xi={type:"class",value:"[ \\n\\r\\t]",description:"[ \\n\\r\\t]"},ki=0,Ei=0,Ni=[{line:1,column:1,seenCR:!1}],Oi=0,Pi=[],Si=0;if("startRule"in gt){if(!(gt.startRule in _t))throw new Error("Can't start parsing from rule \""+gt.startRule+'".');wt=_t[gt.startRule]}if(bt=wt(),bt!==mt&&ki===t.length)return bt;throw bt!==mt&&ki<t.length&&s({type:"end",description:"end of input"}),u(null,Pi,Oi<t.length?t.charAt(Oi):null,Oi<t.length?o(Oi,Oi+1):o(Oi,Oi))}return t(e,Error),{SyntaxError:e,parse:n}}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return s.extendClass(u,{initialize:t||function(){},_update:e||function(){return Promise.resolve()}})}var o=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(e){o(e)}}function u(t){try{a(r["throw"](t))}catch(e){o(e)}}function a(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,u)}a((r=r.apply(t,e)).next())})},s=n(7),u=function(){function t(e,n){r(this,t),this._attrBindings={},this.ref=e,this.view=n,this.options=n.template.options,this._attributeClasses=this.options.attributes}return t.prototype.setAttribute=function(t,e){this.setAsRegisteredAttribute(t,e)||void 0!=e&&this.ref.setAttribute(t,e)},t.prototype.setProperty=function(t,e){this.setAsRegisteredAttribute(t,e)||(this.ref.nodeType?this.ref[t]=e:this.ref.setAttribute(t,e))},t.prototype.setAsRegisteredAttribute=function(t,e){if(this._attrBindings[t])this._attrBindings[t].value=e;else{var n=this._attributeClasses.get(t);if(!n)return!1;this._attrBindings[t]=new n(this.ref,t,e,this.view)}return!0},t.prototype.update=function(t){return o(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._update();case 2:e.t0=regeneratorRuntime.keys(this._attrBindings);case 3:if((e.t1=e.t0()).done){e.next=9;break}return t=e.t1.value,e.next=7,this._attrBindings[t].update();case 7:e.next=3;break;case 9:case"end":return e.stop()}},e,this)}))},t.prototype.destroy=function(){for(var t in this._attrBindings)this._attrBindings[t].destroy()},t}();e.Binding=u,e.binding=i},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,i=function(t){r?setTimeout(t):r(t)},o=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];n(this,t),e||(e={}),this._animationQueue=[],this.tick=e.tick||i,this._id=e._id||2}return t.prototype.child=function(){return this.__child||(this.__child=new t({tick:this.tick,_id:this._id<<2}))},t.prototype.deferOnce=function(t){var e=this;return t.__running||(t.__running=1),t.__running&this._id?void(this._running&&this.child().deferOnce(t)):(t.__running|=this._id,this._animationQueue.push(t),void(this._requestingFrame||(this._requestingFrame=!0,this.tick(function(){e.runNow(),e._requestingFrame=!1}))))},t.prototype.runNow=function(){var t=this._animationQueue;this._animationQueue=[],this._running=!0;for(var e=0;e<t.length;e++){var n=t[e];n.update(),n.__running&=~this._id,this._animationQueue.length&&this.runNow()}this._running=!1},t}();e.RunLoop=o}])});